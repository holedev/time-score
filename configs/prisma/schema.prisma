// https://supabase.com/partners/integrations/prisma

// NOTE: 
// I do not use database of Supabase, I use my own database with prisma to save data locally.
// I only use Supabase for authentication. You can use Supabase for database as well. 

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider  = "postgresql"
  url       = env("DATABASE_URL")
  directUrl = env("DIRECT_URL")
}

enum TeamStatus {
  PENDING
  DONE
}

model Event {
  id          Int      @id @default(autoincrement())
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  title       String
  description String
  duration    Int
  timeStart   DateTime
  timeEnd     DateTime

  teams         Team[]
  EventReviewer EventReviewer[]
}

model EventReviewer {
  id        Int      @id @default(autoincrement())
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  eventId   Int
  userId    String   @db.Uuid // liên kết tới auth.users.id
  isLeader  Boolean  @default(false)

  event Event @relation(fields: [eventId], references: [id], onDelete: Cascade)

  @@unique([eventId, userId]) // một user không thể review 2 lần cùng event
}

model Team {
  id          Int        @id @default(autoincrement())
  createdAt   DateTime   @default(now())
  updatedAt   DateTime   @updatedAt
  title       String
  description String
  image       String
  members     String[]
  order       Int
  status      TeamStatus @default(PENDING)
  Event       Event?     @relation(fields: [eventId], references: [id])
  eventId     Int?
}

// tiêu chí
// phiếu chấm điểm
// log
